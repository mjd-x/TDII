;-------------------------------------------------------------------------------
; Fecha: 04/2021
;
; Programador: Donis, Marina
;
; Descripción: TP1 Ej 2
;
; Modificaciones:
;
;-------------------------------------------------------------------------------

;----------------------------- Archivos Include --------------------------------
$bitdef.h       ; manejo de a bits 
$ioAT89C52.h    ; incluye los registros del microcontrolador
;-------------------------------------------------------------------------------

;--- Se declara el programa ----------------------------------------------------
         NAME    template ; nombre del archivo
         PUBLIC  main ; me permite usar la palabra "main", define etiqueta
;-------------------------------------------------------------------------------

;---- Constantes ---------------------------------------------------------------
   
;Constantes para los segmentos
SEG_CODIGO              EQU     0030h ; inicio seg codigo
SEG_STACK               EQU     00C0h ; Segmento de stack

LONG_STACK              EQU     10    ; Longitud en bytes del stack
;-------------------------------------------------------------------------------

;---SEGMENTO DE CODIGO----------------------------------------------------------
           ; define el punto de inicio del Programa (code)
           ASEG               ; define segmento absoluto
           org 0000h          ; inicio del programa cuando se hace reset
           ljmp    main       ; salto largo (incondicional) al main          
           
;---SEGMENTO DE STACK-----------------------------------------------------------
            ; RSEG ISTACK:IDATA:NOROOT(0)
            ASEG
            org SEG_STACK
stack_init  DS  LONG_STACK     ; Define el segmento de stack       
; etiqueta stack_init, define un array de 10 posiciones (cte LONG_STACK 10)

;---SEGMENTO DE DATOS-----------------------------------------------------------
       RSEG    IDATA_Z:DATA:NOROOT  
       ; poner en donde se pueda (RSEG) en la memoria de datos

;---SEGMENTO DE CÓDIGO----------------------------------------------------------
         RSEG    RCODE
         ORG     SEG_CODIGO     ; define el punto de inicio del Programa (code) 

; Inicia el código principal
main    ; etiqueta que llama al main
        ; Inicializo el STACK
        mov SP,#stack_init-1    ; inicializo el stack, SP = stack pointer     
	
        ; Inicializaciones
   
Loop_ppal:              
        MOV R1, #40 ; doy valor para probar
        
        MOV A, R1 ; cargo el valor de R1 en A
        MOV B, #8 ; cargo valor 8 en B

        DIV AB
        
        
          
salir:  jmp     Loop_ppal
;--------fin del main-----------------------------------------------------------

; FIN DEL ARCHIVO
  END main   ; Cierra el archivo